Bootstrap: docker
From: continuumio/miniconda3

%files
    $PWD/environment.yaml environment.yaml


%post
    conda update -n base -c defaults conda -y
    conda env create -f environment.yml

    # Source environment at runtime
    echo ". /opt/conda/etc/profile.d/conda.sh" >> $SINGULARITY_ENVIRONMENT
    echo "conda activate peal" >> $SINGULARITY_ENVIRONMENT